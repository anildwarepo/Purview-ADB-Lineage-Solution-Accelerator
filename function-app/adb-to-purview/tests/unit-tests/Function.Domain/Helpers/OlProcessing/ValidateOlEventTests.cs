using Moq;
using Xunit;
using Microsoft.Extensions.Logging;
using System.Threading.Tasks;
using Newtonsoft.Json;
using Function.Domain.Helpers.Parser;
using Function.Domain.Models.OL;

namespace UnitTests.Function.Domain.Helpers.OlProcessing
{
    public class ValidateOlEventTests
    {
        private readonly Mock<ILoggerFactory> loggerFactoryMock;
        private readonly IValidateOlEvent _validator;

        public ValidateOlEventTests()
        {
            this.loggerFactoryMock = new Mock<ILoggerFactory>();
            this._validator = new ValidateOlEvent(loggerFactoryMock.Object);
        }

        [Fact]
        public async Task Validate_SynapseOlMessageWithMultiInputs_ReturnsTrue()
        {
            // Arrange
            var olPayload = "{\"eventTime\":\"2023-11-30T22:43:26.834Z\",\"producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"schemaURL\":\"https://openlineage.io/spec/2-0-2/OpenLineage.json#/$defs/RunEvent\",\"eventType\":\"COMPLETE\",\"run\":{\"runId\":\"f1e77e15-4fa3-4523-8f70-9f8ad07aa53e\"},\"job\":{\"namespace\":\"synw-udf-dlz-dv-eu2-01,azuresynapsespark\",\"name\":\"n_b_ccw_ref_condition_raw_to_conformed_lratest_1701383875.adaptive_spark_plan\",\"facets\":{}},\"inputs\":[{\"namespace\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"name\":\"/reference/ref_cndtn_diag\",\"facets\":{\"dataSource\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/DatasourceDatasetFacet.json#/$defs/DatasourceDatasetFacet\",\"name\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"uri\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\"},\"schema\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/SchemaDatasetFacet.json#/$defs/SchemaDatasetFacet\",\"fields\":[{\"name\":\"cndtn_diag_key\",\"type\":\"string\"},{\"name\":\"diag_cd\",\"type\":\"string\"},{\"name\":\"diag_cdst_typ_cd\",\"type\":\"string\"},{\"name\":\"diag_key\",\"type\":\"string\"},{\"name\":\"cndtn_nm\",\"type\":\"string\"},{\"name\":\"cndtn_key\",\"type\":\"string\"},{\"name\":\"udf_meta_obj_key\",\"type\":\"string\"},{\"name\":\"udf_src_del_flg\",\"type\":\"string\"},{\"name\":\"udf_created_dt\",\"type\":\"timestamp\"},{\"name\":\"udf_created_by\",\"type\":\"string\"},{\"name\":\"udf_updated_dt\",\"type\":\"timestamp\"},{\"name\":\"udf_updated_by\",\"type\":\"string\"},{\"name\":\"udf_row_hash\",\"type\":\"string\"},{\"name\":\"udf_src_meta_obj_key\",\"type\":\"string\"}]},\"symlinks\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/SymlinksDatasetFacet.json#/$defs/SymlinksDatasetFacet\",\"identifiers\":[{\"namespace\":\"/reference\",\"name\":\"reference.ref_cndtn_diag\",\"type\":\"TABLE\"}]}},\"inputFacets\":{}},{\"namespace\":\"abfss://rawhistlatestnpii@studfrawnpiidveu202.dfs.core.windows.net\",\"name\":\"/raw/chronic_condition_1997_2021/ccw_chronic_condition_algorithms_1997_2021_current\",\"facets\":{\"dataSource\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/DatasourceDatasetFacet.json#/$defs/DatasourceDatasetFacet\",\"name\":\"abfss://rawhistlatestnpii@studfrawnpiidveu202.dfs.core.windows.net\",\"uri\":\"abfss://rawhistlatestnpii@studfrawnpiidveu202.dfs.core.windows.net\"},\"schema\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/SchemaDatasetFacet.json#/$defs/SchemaDatasetFacet\",\"fields\":[{\"name\":\"algorithms\",\"type\":\"string\"},{\"name\":\"reference_period\",\"type\":\"string\"},{\"name\":\"valid_ICD09_codes\",\"type\":\"string\"},{\"name\":\"valid_ICD10_codes\",\"type\":\"string\"},{\"name\":\"number_or_type_of_claims\",\"type\":\"string\"},{\"name\":\"udf_file_name\",\"type\":\"string\"},{\"name\":\"udf_year\",\"type\":\"string\"},{\"name\":\"udf_mon\",\"type\":\"string\"},{\"name\":\"udf_day\",\"type\":\"string\"},{\"name\":\"udf_upsert_timestamp\",\"type\":\"timestamp\"},{\"name\":\"udf_ingested_date\",\"type\":\"date\"}]},\"symlinks\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/SymlinksDatasetFacet.json#/$defs/SymlinksDatasetFacet\",\"identifiers\":[{\"namespace\":\"/raw/chronic_condition_1997_2021\",\"name\":\"raw.ccw_chronic_condition_algorithms_1997_2021_current\",\"type\":\"TABLE\"}]}},\"inputFacets\":{}},{\"namespace\":\"abfss://rawhistlatestnpii@studfrawnpiidveu202.dfs.core.windows.net\",\"name\":\"/raw/chronic_condition_1997_2021/ccw_chronic_condition_algorithms_1997_2021_current\",\"facets\":{\"dataSource\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/DatasourceDatasetFacet.json#/$defs/DatasourceDatasetFacet\",\"name\":\"abfss://rawhistlatestnpii@studfrawnpiidveu202.dfs.core.windows.net\",\"uri\":\"abfss://rawhistlatestnpii@studfrawnpiidveu202.dfs.core.windows.net\"},\"schema\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/SchemaDatasetFacet.json#/$defs/SchemaDatasetFacet\",\"fields\":[{\"name\":\"algorithms\",\"type\":\"string\"},{\"name\":\"reference_period\",\"type\":\"string\"},{\"name\":\"valid_ICD09_codes\",\"type\":\"string\"},{\"name\":\"valid_ICD10_codes\",\"type\":\"string\"},{\"name\":\"number_or_type_of_claims\",\"type\":\"string\"},{\"name\":\"udf_file_name\",\"type\":\"string\"},{\"name\":\"udf_year\",\"type\":\"string\"},{\"name\":\"udf_mon\",\"type\":\"string\"},{\"name\":\"udf_day\",\"type\":\"string\"},{\"name\":\"udf_upsert_timestamp\",\"type\":\"timestamp\"},{\"name\":\"udf_ingested_date\",\"type\":\"date\"}]},\"symlinks\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/SymlinksDatasetFacet.json#/$defs/SymlinksDatasetFacet\",\"identifiers\":[{\"namespace\":\"/raw/chronic_condition_1997_2021\",\"name\":\"raw.ccw_chronic_condition_algorithms_1997_2021_current\",\"type\":\"TABLE\"}]}},\"inputFacets\":{}},{\"namespace\":\"abfss://rawhistlatestnpii@studfrawnpiidveu202.dfs.core.windows.net\",\"name\":\"/raw/chronic_condition/ccw_chronic_condition_algorithms_current\",\"facets\":{\"dataSource\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/DatasourceDatasetFacet.json#/$defs/DatasourceDatasetFacet\",\"name\":\"abfss://rawhistlatestnpii@studfrawnpiidveu202.dfs.core.windows.net\",\"uri\":\"abfss://rawhistlatestnpii@studfrawnpiidveu202.dfs.core.windows.net\"},\"schema\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/SchemaDatasetFacet.json#/$defs/SchemaDatasetFacet\",\"fields\":[{\"name\":\"algorithms\",\"type\":\"string\"},{\"name\":\"reference_period\",\"type\":\"string\"},{\"name\":\"valid_ICD10_codes\",\"type\":\"string\"},{\"name\":\"number_or_type_of_claims\",\"type\":\"string\"},{\"name\":\"udf_file_name\",\"type\":\"string\"},{\"name\":\"udf_year\",\"type\":\"string\"},{\"name\":\"udf_mon\",\"type\":\"string\"},{\"name\":\"udf_day\",\"type\":\"string\"},{\"name\":\"udf_upsert_timestamp\",\"type\":\"timestamp\"},{\"name\":\"udf_ingested_date\",\"type\":\"date\"}]},\"symlinks\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/SymlinksDatasetFacet.json#/$defs/SymlinksDatasetFacet\",\"identifiers\":[{\"namespace\":\"/raw/chronic_condition\",\"name\":\"raw.ccw_chronic_condition_algorithms_current\",\"type\":\"TABLE\"}]}},\"inputFacets\":{}},{\"namespace\":\"abfss://rawhistlatestnpii@studfrawnpiidveu202.dfs.core.windows.net\",\"name\":\"/raw/chronic_condition/ccw_chronic_condition_algorithms_current\",\"facets\":{\"dataSource\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/DatasourceDatasetFacet.json#/$defs/DatasourceDatasetFacet\",\"name\":\"abfss://rawhistlatestnpii@studfrawnpiidveu202.dfs.core.windows.net\",\"uri\":\"abfss://rawhistlatestnpii@studfrawnpiidveu202.dfs.core.windows.net\"},\"schema\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/SchemaDatasetFacet.json#/$defs/SchemaDatasetFacet\",\"fields\":[{\"name\":\"algorithms\",\"type\":\"string\"},{\"name\":\"reference_period\",\"type\":\"string\"},{\"name\":\"valid_ICD10_codes\",\"type\":\"string\"},{\"name\":\"number_or_type_of_claims\",\"type\":\"string\"},{\"name\":\"udf_file_name\",\"type\":\"string\"},{\"name\":\"udf_year\",\"type\":\"string\"},{\"name\":\"udf_mon\",\"type\":\"string\"},{\"name\":\"udf_day\",\"type\":\"string\"},{\"name\":\"udf_upsert_timestamp\",\"type\":\"timestamp\"},{\"name\":\"udf_ingested_date\",\"type\":\"date\"}]},\"symlinks\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/SymlinksDatasetFacet.json#/$defs/SymlinksDatasetFacet\",\"identifiers\":[{\"namespace\":\"/raw/chronic_condition\",\"name\":\"raw.ccw_chronic_condition_algorithms_current\",\"type\":\"TABLE\"}]}},\"inputFacets\":{}}],\"outputs\":[]}";
            var olEvent = JsonConvert.DeserializeObject<Event>(olPayload);

            // Act
            Xunit.Assert.NotNull(olEvent);
            var actual = _validator.Validate(olEvent);

            // Assert
            Xunit.Assert.True(actual);
        }

        [Fact]
        public async Task Validate_SynapseOlMessageWithNoIO_ReturnsFalse()
        {
            // Arrange
            var olPayload = "{\"eventTime\":\"2023-11-30T22:43:26.834Z\",\"producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"schemaURL\":\"https://openlineage.io/spec/2-0-2/OpenLineage.json#/$defs/RunEvent\",\"eventType\":\"COMPLETE\",\"run\":{\"runId\":\"f1e77e15-4fa3-4523-8f70-9f8ad07aa53e\"},\"job\":{\"namespace\":\"synw-udf-dlz-dv-eu2-01,azuresynapsespark\",\"name\":\"n_b_ccw_ref_condition_raw_to_conformed_lratest_1701383875.adaptive_spark_plan\",\"facets\":{}},\"inputs\":[],\"outputs\":[]}";
            var olEvent = JsonConvert.DeserializeObject<Event>(olPayload);

            // Act
            Xunit.Assert.NotNull(olEvent);
            var actual = _validator.Validate(olEvent);

            // Assert
            Xunit.Assert.False(actual);
        }

        [Fact]
        public async Task Validate_SynapseOlMessageWithNoIO_OutputExists_ReturnsTrue()
        {
            // Arrange
            var olPayload = "{\"eventTime\":\"2023-12-05T18:07:00.6Z\",\"producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"schemaURL\":\"https://openlineage.io/spec/2-0-2/OpenLineage.json#/$defs/RunEvent\",\"eventType\":\"COMPLETE\",\"run\":{\"runId\":\"f51d312d-adf0-4187-ac90-23d563a6d21e\",\"facets\":{\"spark.logicalPlan\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/2-0-2/OpenLineage.json#/$defs/RunFacet\",\"plan\":[{\"class\":\"org.apache.spark.sql.delta.commands.MergeIntoCommand\",\"num-children\":0,\"source\":[{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"src\",\"qualifier\":[]},\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"_tmp_ccw_ref_condition_\",\"qualifier\":[]},\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.View\",\"num-children\":1,\"desc\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogTable\",\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.TableIdentifier\",\"table\":\"_tmp_ccw_ref_condition_\"},\"tableType\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogTableType\",\"name\":\"VIEW\"},\"storage\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogStorageFormat\",\"compressed\":false,\"properties\":null},\"schema\":{\"type\":\"struct\",\"fields\":[{\"name\":\"cndtn_key\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"cndtn_nm\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"cndtn_cd\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"chrnc_cndtn_flg\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"risk_calc_flg\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"gap_calc_flg\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"cndtn_mgmt_flg\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"tgt_cndtn_flg\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ref_prd_yr\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}},{\"name\":\"meddra_cd\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"udf_meta_obj_key\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"udf_src_del_flg\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"udf_created_dt\",\"type\":\"timestamp\",\"nullable\":false,\"metadata\":{}},{\"name\":\"udf_created_by\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"udf_updated_dt\",\"type\":\"timestamp\",\"nullable\":false,\"metadata\":{}},{\"name\":\"udf_updated_by\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"udf_row_hash\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"udf_src_meta_obj_key\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]},\"partitionColumnNames\":[],\"owner\":\"\",\"createTime\":1701799541447,\"lastAccessTime\":-1,\"createVersion\":\"\",\"properties\":null,\"viewText\":\"with icd10_97_21 as\\n        (select upper(algorithms)                                              as cndtn_nm,\\n                int(SUBSTRING(reference_period, 1, 1))                 as ref_prd_yr,\\n                 sha2(upper(algorithms),256)                                         as cndtn_key\\n          from raw.ccw_chronic_condition_algorithms_1997_2021_current),\\n     icd9_97_21 as\\n         (select upper(algorithms)                                             as cndtn_nm,\\n                int(SUBSTRING(reference_period, 1, 1))                 as ref_prd_yr,\\n                 sha2(upper(algorithms),256)                                        as cndtn_key\\n          from raw.ccw_chronic_condition_algorithms_1997_2021_current),\\n     icd10_current as\\n         (select upper(algorithms)                                              as cndtn_nm,\\n                int(SUBSTRING(reference_period, 1, 1))                 as ref_prd_yr,\\n                 sha2(upper(algorithms),256)                                         as cndtn_key\\n          from raw.ccw_chronic_condition_algorithms_current),\\n     combined_result as\\n         (select *\\n          from icd10_97_21\\n          union\\n          select *\\n          from icd9_97_21\\n          union\\n          select *\\n          from icd10_current),\\n     dedupe_ref_cndtn as (\\n         select cndtn_nm as cndtn_nm, \\n         ref_prd_yr,\\n         cndtn_key ,\\n         '' as cndtn_cd,\\n         '' as risk_calc_flg,\\n         '' as gap_calc_flg,\\n         '' as cndtn_mgmt_flg,\\n         'Y'                                            as chrnc_cndtn_flg,\\n         '' as tgt_cndtn_flg,\\n         row_number() over (partition by cndtn_nm order by ref_prd_yr desc) as rn\\n         from combined_result)\\nselect cndtn_key,\\n       cndtn_nm,\\n       cndtn_cd,\\n       chrnc_cndtn_flg,\\n       risk_calc_flg,\\n       gap_calc_flg,\\n       cndtn_mgmt_flg,\\n       tgt_cndtn_flg,\\n       ref_prd_yr,\\n       '' as meddra_cd,\\n       sha2(concat_ws('~','table','conformed','ref_cndtn'),256) as udf_meta_obj_key,\\n       'N' as udf_src_del_flg,\\n       current_timestamp()                            as udf_created_dt,\\n       concat_ws('~','PL_ccw_raw_to_conformed','123') as udf_created_by,\\n       current_timestamp()                            as udf_updated_dt,\\n       concat_ws('~','PL_ccw_raw_to_conformed','123') as udf_updated_by,\\n       sha2(upper(concat_ws('~', cndtn_cd, chrnc_cndtn_flg, risk_calc_flg, gap_calc_flg, cndtn_mgmt_flg,tgt_cndtn_flg,\\n       int(SUBSTRING(reference_period, 1, 1)))),256) as udf_row_hash,\\n       sha2(concat_ws('~','sor','conformed','ref_cndtn'),256) as udf_src_meta_obj_key\\nfrom dedupe_ref_cndtn rf\\nleft join raw.ccw_chronic_condition_algorithms_current ccw on ccw.algorithms = rf.cndtn_nm\\nwhere rn =1\",\"unsupportedFeatures\":[],\"tracksPartitionsInCatalog\":false,\"schemaPreservesCase\":true,\"ignoredProperties\":null},\"isTempView\":true,\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Project\",\"num-children\":1,\"projectList\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"cndtn_key\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4008,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3993,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"cndtn_nm\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4009,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4000,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"cndtn_cd\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4010,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_cd\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4001,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"chrnc_cndtn_flg\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4011,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"chrnc_cndtn_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4005,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"risk_calc_flg\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4012,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"risk_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4002,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"gap_calc_flg\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4013,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"gap_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4003,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"cndtn_mgmt_flg\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4014,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_mgmt_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4004,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"tgt_cndtn_flg\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4015,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"tgt_cndtn_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4006,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"ref_prd_yr\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4016,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"integer\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3992,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"meddra_cd\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4017,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"meddra_cd\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3982,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_meta_obj_key\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4018,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_meta_obj_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3983,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_src_del_flg\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4019,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_src_del_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3984,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_created_dt\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4020,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"timestamp\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_created_dt\",\"dataType\":\"timestamp\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3985,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_created_by\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4021,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_created_by\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3986,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_updated_dt\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4022,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"timestamp\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_updated_dt\",\"dataType\":\"timestamp\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3987,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_updated_by\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4023,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_updated_by\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3988,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_row_hash\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4024,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_row_hash\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3989,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_src_meta_obj_key\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4025,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_src_meta_obj_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3990,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}]],\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.WithCTE\",\"num-children\":6,\"plan\":5,\"cteDefs\":[0,1,2,3,4]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.CTERelationDef\",\"num-children\":1,\"child\":0,\"id\":55,\"underSubquery\":false},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"icd10_97_21\",\"qualifier\":[]},\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Project\",\"num-children\":1,\"projectList\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"cndtn_nm\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3991,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Upper\",\"num-children\":1,\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"algorithms\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4026,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[spark_catalog, raw, ccw_chronic_condition_algorithms_1997_2021_current]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"ref_prd_yr\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3992,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"integer\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Substring\",\"num-children\":3,\"str\":0,\"pos\":1,\"len\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"reference_period\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4027,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[spark_catalog, raw, ccw_chronic_condition_algorithms_1997_2021_current]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"1\",\"dataType\":\"integer\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"1\",\"dataType\":\"integer\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"cndtn_key\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3993,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Sha2\",\"num-children\":2,\"left\":0,\"right\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"binary\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Upper\",\"num-children\":1,\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"algorithms\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4026,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[spark_catalog, raw, ccw_chronic_condition_algorithms_1997_2021_current]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"256\",\"dataType\":\"integer\"}]],\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"ccw_chronic_condition_algorithms_1997_2021_current\",\"qualifier\":\"[spark_catalog, raw]\"},\"child\":0},{\"class\":\"org.apache.spark.sql.execution.datasources.LogicalRelation\",\"num-children\":0,\"relation\":null,\"output\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"algorithms\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4026,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"reference_period\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4027,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"valid_ICD09_codes\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4028,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"valid_ICD10_codes\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4029,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"number_or_type_of_claims\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4030,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_file_name\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4031,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_year\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4032,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_mon\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4033,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_day\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4034,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_upsert_timestamp\",\"dataType\":\"timestamp\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4035,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_ingested_date\",\"dataType\":\"date\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4036,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}]],\"catalogTable\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogTable\",\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.TableIdentifier\",\"table\":\"ccw_chronic_condition_algorithms_1997_2021_current\",\"database\":\"raw\"},\"tableType\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogTableType\",\"name\":\"EXTERNAL\"},\"storage\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogStorageFormat\",\"locationUri\":null,\"inputFormat\":\"org.apache.hadoop.mapred.SequenceFileInputFormat\",\"outputFormat\":\"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\",\"serde\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"compressed\":false,\"properties\":null},\"schema\":{\"type\":\"struct\",\"fields\":[]},\"provider\":\"delta\",\"partitionColumnNames\":[],\"owner\":\"trusted-service-user\",\"createTime\":1692028047000,\"lastAccessTime\":0,\"createVersion\":\"3.3.1.5.2-92314920\",\"properties\":null,\"stats\":null,\"unsupportedFeatures\":[],\"tracksPartitionsInCatalog\":false,\"schemaPreservesCase\":true,\"ignoredProperties\":null},\"isStreaming\":false},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.CTERelationDef\",\"num-children\":1,\"child\":0,\"id\":56,\"underSubquery\":false},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"icd9_97_21\",\"qualifier\":[]},\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Project\",\"num-children\":1,\"projectList\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"cndtn_nm\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3994,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Upper\",\"num-children\":1,\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"algorithms\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4037,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[spark_catalog, raw, ccw_chronic_condition_algorithms_1997_2021_current]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"ref_prd_yr\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3995,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"integer\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Substring\",\"num-children\":3,\"str\":0,\"pos\":1,\"len\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"reference_period\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4038,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[spark_catalog, raw, ccw_chronic_condition_algorithms_1997_2021_current]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"1\",\"dataType\":\"integer\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"1\",\"dataType\":\"integer\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"cndtn_key\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3996,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Sha2\",\"num-children\":2,\"left\":0,\"right\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"binary\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Upper\",\"num-children\":1,\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"algorithms\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4037,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[spark_catalog, raw, ccw_chronic_condition_algorithms_1997_2021_current]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"256\",\"dataType\":\"integer\"}]],\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"ccw_chronic_condition_algorithms_1997_2021_current\",\"qualifier\":\"[spark_catalog, raw]\"},\"child\":0},{\"class\":\"org.apache.spark.sql.execution.datasources.LogicalRelation\",\"num-children\":0,\"relation\":null,\"output\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"algorithms\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4037,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"reference_period\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4038,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"valid_ICD09_codes\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4039,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"valid_ICD10_codes\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4040,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"number_or_type_of_claims\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4041,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_file_name\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4042,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_year\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4043,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_mon\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4044,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_day\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4045,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_upsert_timestamp\",\"dataType\":\"timestamp\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4046,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_ingested_date\",\"dataType\":\"date\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4047,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}]],\"catalogTable\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogTable\",\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.TableIdentifier\",\"table\":\"ccw_chronic_condition_algorithms_1997_2021_current\",\"database\":\"raw\"},\"tableType\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogTableType\",\"name\":\"EXTERNAL\"},\"storage\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogStorageFormat\",\"locationUri\":null,\"inputFormat\":\"org.apache.hadoop.mapred.SequenceFileInputFormat\",\"outputFormat\":\"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\",\"serde\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"compressed\":false,\"properties\":null},\"schema\":{\"type\":\"struct\",\"fields\":[]},\"provider\":\"delta\",\"partitionColumnNames\":[],\"owner\":\"trusted-service-user\",\"createTime\":1692028047000,\"lastAccessTime\":0,\"createVersion\":\"3.3.1.5.2-92314920\",\"properties\":null,\"stats\":null,\"unsupportedFeatures\":[],\"tracksPartitionsInCatalog\":false,\"schemaPreservesCase\":true,\"ignoredProperties\":null},\"isStreaming\":false},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.CTERelationDef\",\"num-children\":1,\"child\":0,\"id\":57,\"underSubquery\":false},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"icd10_current\",\"qualifier\":[]},\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Project\",\"num-children\":1,\"projectList\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"cndtn_nm\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3997,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Upper\",\"num-children\":1,\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"algorithms\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4048,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[spark_catalog, raw, ccw_chronic_condition_algorithms_current]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"ref_prd_yr\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3998,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"integer\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Substring\",\"num-children\":3,\"str\":0,\"pos\":1,\"len\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"reference_period\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4049,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[spark_catalog, raw, ccw_chronic_condition_algorithms_current]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"1\",\"dataType\":\"integer\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"1\",\"dataType\":\"integer\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"cndtn_key\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3999,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Sha2\",\"num-children\":2,\"left\":0,\"right\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"binary\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Upper\",\"num-children\":1,\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"algorithms\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4048,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[spark_catalog, raw, ccw_chronic_condition_algorithms_current]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"256\",\"dataType\":\"integer\"}]],\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"ccw_chronic_condition_algorithms_current\",\"qualifier\":\"[spark_catalog, raw]\"},\"child\":0},{\"class\":\"org.apache.spark.sql.execution.datasources.LogicalRelation\",\"num-children\":0,\"relation\":null,\"output\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"algorithms\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4048,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"reference_period\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4049,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"valid_ICD10_codes\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4050,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"number_or_type_of_claims\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4051,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_file_name\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4052,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_year\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4053,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_mon\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4054,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_day\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4055,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_upsert_timestamp\",\"dataType\":\"timestamp\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4056,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_ingested_date\",\"dataType\":\"date\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4057,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}]],\"catalogTable\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogTable\",\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.TableIdentifier\",\"table\":\"ccw_chronic_condition_algorithms_current\",\"database\":\"raw\"},\"tableType\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogTableType\",\"name\":\"EXTERNAL\"},\"storage\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogStorageFormat\",\"locationUri\":null,\"inputFormat\":\"org.apache.hadoop.mapred.SequenceFileInputFormat\",\"outputFormat\":\"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\",\"serde\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"compressed\":false,\"properties\":null},\"schema\":{\"type\":\"struct\",\"fields\":[]},\"provider\":\"delta\",\"partitionColumnNames\":[],\"owner\":\"trusted-service-user\",\"createTime\":1692026731000,\"lastAccessTime\":0,\"createVersion\":\"3.3.1.5.2-92314920\",\"properties\":null,\"stats\":null,\"unsupportedFeatures\":[],\"tracksPartitionsInCatalog\":false,\"schemaPreservesCase\":true,\"ignoredProperties\":null},\"isStreaming\":false},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.CTERelationDef\",\"num-children\":1,\"child\":0,\"id\":58,\"underSubquery\":false},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"combined_result\",\"qualifier\":[]},\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Distinct\",\"num-children\":1,\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Union\",\"num-children\":2,\"children\":[0,1],\"byName\":false,\"allowMissingCol\":false},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Distinct\",\"num-children\":1,\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Union\",\"num-children\":2,\"children\":[0,1],\"byName\":false,\"allowMissingCol\":false},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Project\",\"num-children\":1,\"projectList\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3991,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd10_97_21]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3992,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd10_97_21]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3993,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd10_97_21]\"}]],\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"icd10_97_21\",\"qualifier\":[]},\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.CTERelationRef\",\"num-children\":0,\"cteId\":55,\"_resolved\":true,\"output\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3991,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd10_97_21]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3992,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd10_97_21]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3993,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd10_97_21]\"}]]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Project\",\"num-children\":1,\"projectList\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3994,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd9_97_21]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3995,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd9_97_21]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3996,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd9_97_21]\"}]],\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"icd9_97_21\",\"qualifier\":[]},\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.CTERelationRef\",\"num-children\":0,\"cteId\":56,\"_resolved\":true,\"output\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3994,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd9_97_21]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3995,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd9_97_21]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3996,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd9_97_21]\"}]]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Project\",\"num-children\":1,\"projectList\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3997,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd10_current]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3998,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd10_current]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3999,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd10_current]\"}]],\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"icd10_current\",\"qualifier\":[]},\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.CTERelationRef\",\"num-children\":0,\"cteId\":57,\"_resolved\":true,\"output\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3997,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd10_current]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3998,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd10_current]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3999,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[icd10_current]\"}]]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.CTERelationDef\",\"num-children\":1,\"child\":0,\"id\":59,\"underSubquery\":false},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"dedupe_ref_cndtn\",\"qualifier\":[]},\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Project\",\"num-children\":1,\"projectList\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4000,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3992,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3993,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_cd\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4001,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"risk_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4002,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"gap_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4003,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_mgmt_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4004,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"chrnc_cndtn_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4005,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"tgt_cndtn_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4006,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"rn\",\"dataType\":\"integer\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4007,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}]],\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Project\",\"num-children\":1,\"projectList\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4000,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3992,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3993,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_cd\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4001,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"risk_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4002,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"gap_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4003,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_mgmt_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4004,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"chrnc_cndtn_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4005,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"tgt_cndtn_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4006,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3991,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"rn\",\"dataType\":\"integer\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4007,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"rn\",\"dataType\":\"integer\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4007,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}]],\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Window\",\"num-children\":1,\"windowExpressions\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"rn\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4007,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.WindowExpression\",\"num-children\":2,\"windowFunction\":0,\"windowSpec\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.RowNumber\",\"num-children\":0},{\"class\":\"org.apache.spark.sql.catalyst.expressions.WindowSpecDefinition\",\"num-children\":3,\"partitionSpec\":[0],\"orderSpec\":[1],\"frameSpecification\":2},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3991,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.SortOrder\",\"num-children\":1,\"child\":0,\"direction\":{\"object\":\"org.apache.spark.sql.catalyst.expressions.Descending$\"},\"nullOrdering\":{\"object\":\"org.apache.spark.sql.catalyst.expressions.NullsLast$\"},\"sameOrderExpressions\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3992,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.SpecifiedWindowFrame\",\"num-children\":2,\"frameType\":{\"object\":\"org.apache.spark.sql.catalyst.expressions.RowFrame$\"},\"lower\":0,\"upper\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.UnboundedPreceding$\",\"num-children\":0},{\"class\":\"org.apache.spark.sql.catalyst.expressions.CurrentRow$\",\"num-children\":0}]],\"partitionSpec\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3991,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"}]],\"orderSpec\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.SortOrder\",\"num-children\":1,\"child\":0,\"direction\":{\"object\":\"org.apache.spark.sql.catalyst.expressions.Descending$\"},\"nullOrdering\":{\"object\":\"org.apache.spark.sql.catalyst.expressions.NullsLast$\"},\"sameOrderExpressions\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3992,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"}]],\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Project\",\"num-children\":1,\"projectList\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"cndtn_nm\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4000,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3991,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3992,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3993,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"cndtn_cd\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4001,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"\",\"dataType\":\"string\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"risk_calc_flg\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4002,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"\",\"dataType\":\"string\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"gap_calc_flg\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4003,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"\",\"dataType\":\"string\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"cndtn_mgmt_flg\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4004,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"\",\"dataType\":\"string\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"chrnc_cndtn_flg\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4005,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"Y\",\"dataType\":\"string\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"tgt_cndtn_flg\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4006,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"\",\"dataType\":\"string\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3991,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"}]],\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"combined_result\",\"qualifier\":[]},\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.CTERelationRef\",\"num-children\":0,\"cteId\":58,\"_resolved\":true,\"output\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3991,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3992,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3993,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[combined_result]\"}]]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Project\",\"num-children\":1,\"projectList\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3993,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4000,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_cd\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4001,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"chrnc_cndtn_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4005,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"risk_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4002,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"gap_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4003,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_mgmt_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4004,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"tgt_cndtn_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4006,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3992,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"meddra_cd\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3982,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"\",\"dataType\":\"string\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_meta_obj_key\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3983,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Sha2\",\"num-children\":2,\"left\":0,\"right\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"binary\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.ConcatWs\",\"num-children\":4,\"children\":[0,1,2,3]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"~\",\"dataType\":\"string\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"table\",\"dataType\":\"string\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"conformed\",\"dataType\":\"string\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"ref_cndtn\",\"dataType\":\"string\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"256\",\"dataType\":\"integer\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_src_del_flg\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3984,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"N\",\"dataType\":\"string\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_created_dt\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3985,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"2023-12-05 18:06:46.142\",\"dataType\":\"timestamp\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_created_by\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3986,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.ConcatWs\",\"num-children\":3,\"children\":[0,1,2]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"~\",\"dataType\":\"string\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"PL_ccw_raw_to_conformed\",\"dataType\":\"string\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"123\",\"dataType\":\"string\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_updated_dt\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3987,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"2023-12-05 18:06:46.142\",\"dataType\":\"timestamp\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_updated_by\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3988,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.ConcatWs\",\"num-children\":3,\"children\":[0,1,2]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"~\",\"dataType\":\"string\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"PL_ccw_raw_to_conformed\",\"dataType\":\"string\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"123\",\"dataType\":\"string\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_row_hash\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3989,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Sha2\",\"num-children\":2,\"left\":0,\"right\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"binary\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Upper\",\"num-children\":1,\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.expressions.ConcatWs\",\"num-children\":8,\"children\":[0,1,2,3,4,5,6,7]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"~\",\"dataType\":\"string\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_cd\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4001,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"chrnc_cndtn_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4005,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"risk_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4002,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"gap_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4003,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_mgmt_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4004,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"tgt_cndtn_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4006,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"string\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"integer\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Substring\",\"num-children\":3,\"str\":0,\"pos\":1,\"len\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"reference_period\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4059,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[ccw]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"1\",\"dataType\":\"integer\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"1\",\"dataType\":\"integer\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"256\",\"dataType\":\"integer\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Alias\",\"num-children\":1,\"child\":0,\"name\":\"udf_src_meta_obj_key\",\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3990,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[],\"nonInheritableMetadataKeys\":[]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Sha2\",\"num-children\":2,\"left\":0,\"right\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Cast\",\"num-children\":1,\"child\":0,\"dataType\":\"binary\",\"timeZoneId\":\"Etc/UTC\",\"ansiEnabled\":false},{\"class\":\"org.apache.spark.sql.catalyst.expressions.ConcatWs\",\"num-children\":4,\"children\":[0,1,2,3]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"~\",\"dataType\":\"string\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"sor\",\"dataType\":\"string\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"conformed\",\"dataType\":\"string\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"ref_cndtn\",\"dataType\":\"string\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"256\",\"dataType\":\"integer\"}]],\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Filter\",\"num-children\":1,\"condition\":[{\"class\":\"org.apache.spark.sql.catalyst.expressions.EqualTo\",\"num-children\":2,\"left\":0,\"right\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"rn\",\"dataType\":\"integer\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4007,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"1\",\"dataType\":\"integer\"}],\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.Join\",\"num-children\":2,\"left\":0,\"right\":1,\"joinType\":{\"object\":\"org.apache.spark.sql.catalyst.plans.LeftOuter$\"},\"condition\":[{\"class\":\"org.apache.spark.sql.catalyst.expressions.EqualTo\",\"num-children\":2,\"left\":0,\"right\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"algorithms\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4058,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[ccw]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4000,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[rf]\"}],\"hint\":null},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"rf\",\"qualifier\":[]},\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"dedupe_ref_cndtn\",\"qualifier\":[]},\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.CTERelationRef\",\"num-children\":0,\"cteId\":59,\"_resolved\":true,\"output\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4000,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[dedupe_ref_cndtn]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3992,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[dedupe_ref_cndtn]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3993,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[dedupe_ref_cndtn]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_cd\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4001,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[dedupe_ref_cndtn]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"risk_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4002,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[dedupe_ref_cndtn]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"gap_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4003,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[dedupe_ref_cndtn]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_mgmt_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4004,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[dedupe_ref_cndtn]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"chrnc_cndtn_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4005,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[dedupe_ref_cndtn]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"tgt_cndtn_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4006,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[dedupe_ref_cndtn]\"}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"rn\",\"dataType\":\"integer\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4007,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[dedupe_ref_cndtn]\"}]]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"ccw\",\"qualifier\":[]},\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"ccw_chronic_condition_algorithms_current\",\"qualifier\":\"[spark_catalog, raw]\"},\"child\":0},{\"class\":\"org.apache.spark.sql.execution.datasources.LogicalRelation\",\"num-children\":0,\"relation\":null,\"output\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"algorithms\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4058,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"reference_period\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4059,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"valid_ICD10_codes\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4060,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"number_or_type_of_claims\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4061,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_file_name\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4062,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_year\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4063,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_mon\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4064,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_day\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4065,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_upsert_timestamp\",\"dataType\":\"timestamp\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4066,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_ingested_date\",\"dataType\":\"date\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4067,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}]],\"catalogTable\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogTable\",\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.TableIdentifier\",\"table\":\"ccw_chronic_condition_algorithms_current\",\"database\":\"raw\"},\"tableType\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogTableType\",\"name\":\"EXTERNAL\"},\"storage\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogStorageFormat\",\"locationUri\":null,\"inputFormat\":\"org.apache.hadoop.mapred.SequenceFileInputFormat\",\"outputFormat\":\"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\",\"serde\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"compressed\":false,\"properties\":null},\"schema\":{\"type\":\"struct\",\"fields\":[]},\"provider\":\"delta\",\"partitionColumnNames\":[],\"owner\":\"trusted-service-user\",\"createTime\":1692026731000,\"lastAccessTime\":0,\"createVersion\":\"3.3.1.5.2-92314920\",\"properties\":null,\"stats\":null,\"unsupportedFeatures\":[],\"tracksPartitionsInCatalog\":false,\"schemaPreservesCase\":true,\"ignoredProperties\":null},\"isStreaming\":false}],\"target\":[{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"cndtn\",\"qualifier\":[]},\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.SubqueryAlias\",\"num-children\":1,\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.AliasIdentifier\",\"name\":\"ref_cndtn\",\"qualifier\":\"[spark_catalog, reference]\"},\"child\":0},{\"class\":\"org.apache.spark.sql.execution.datasources.LogicalRelation\",\"num-children\":0,\"relation\":null,\"output\":[[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3964,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3965,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_cd\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3966,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"chrnc_cndtn_flg\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3967,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"risk_calc_flg\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3968,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"gap_calc_flg\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3969,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_mgmt_flg\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3970,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"tgt_cndtn_flg\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3971,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3972,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"meddra_cd\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3973,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_meta_obj_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3974,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_src_del_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3975,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_created_dt\",\"dataType\":\"timestamp\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3976,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_created_by\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3977,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_updated_dt\",\"dataType\":\"timestamp\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3978,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_updated_by\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3979,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_row_hash\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3980,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_src_meta_obj_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3981,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}]],\"catalogTable\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogTable\",\"identifier\":{\"product-class\":\"org.apache.spark.sql.catalyst.TableIdentifier\",\"table\":\"ref_cndtn\",\"database\":\"reference\"},\"tableType\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogTableType\",\"name\":\"EXTERNAL\"},\"storage\":{\"product-class\":\"org.apache.spark.sql.catalyst.catalog.CatalogStorageFormat\",\"locationUri\":null,\"inputFormat\":\"org.apache.hadoop.mapred.SequenceFileInputFormat\",\"outputFormat\":\"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\",\"serde\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"compressed\":false,\"properties\":null},\"schema\":{\"type\":\"struct\",\"fields\":[]},\"provider\":\"delta\",\"partitionColumnNames\":[],\"owner\":\"trusted-service-user\",\"createTime\":1690891144000,\"lastAccessTime\":0,\"createVersion\":\"3.3.1.5.2-92314920\",\"properties\":null,\"unsupportedFeatures\":[],\"tracksPartitionsInCatalog\":true,\"schemaPreservesCase\":true,\"ignoredProperties\":null},\"isStreaming\":false}],\"targetFileIndex\":null,\"condition\":[{\"class\":\"org.apache.spark.sql.catalyst.expressions.EqualTo\",\"num-children\":2,\"left\":0,\"right\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3964,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[cndtn]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4008,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"}],\"matchedClauses\":[[{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeIntoMatchedUpdateClause\",\"num-children\":19,\"condition\":[{\"class\":\"org.apache.spark.sql.catalyst.expressions.Not\",\"num-children\":1,\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.expressions.EqualTo\",\"num-children\":2,\"left\":0,\"right\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3965,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[cndtn]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4009,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"}],\"actions\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Not\",\"num-children\":1,\"child\":0},{\"class\":\"org.apache.spark.sql.catalyst.expressions.EqualTo\",\"num-children\":2,\"left\":0,\"right\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3965,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[cndtn]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4009,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[cndtn_key]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4008,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[cndtn_nm]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4009,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[cndtn_cd]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_cd\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3966,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[chrnc_cndtn_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"chrnc_cndtn_flg\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3967,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[risk_calc_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"risk_calc_flg\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3968,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[gap_calc_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"gap_calc_flg\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3969,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[cndtn_mgmt_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_mgmt_flg\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3970,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[tgt_cndtn_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"tgt_cndtn_flg\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3971,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[ref_prd_yr]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4016,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[meddra_cd]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"meddra_cd\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3973,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_meta_obj_key]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_meta_obj_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4018,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_src_del_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_src_del_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4019,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_created_dt]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_created_dt\",\"dataType\":\"timestamp\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3976,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_created_by]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_created_by\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3977,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_updated_dt]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"2023-12-05 18:06:46.142\",\"dataType\":\"timestamp\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_updated_by]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_updated_by\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4023,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_row_hash]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_row_hash\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4024,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_src_meta_obj_key]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_src_meta_obj_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3981,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}],[{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeIntoMatchedUpdateClause\",\"num-children\":19,\"condition\":[{\"class\":\"org.apache.spark.sql.catalyst.expressions.EqualTo\",\"num-children\":2,\"left\":0,\"right\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_src_del_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3975,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[cndtn]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"Y\",\"dataType\":\"string\"}],\"actions\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]},{\"class\":\"org.apache.spark.sql.catalyst.expressions.EqualTo\",\"num-children\":2,\"left\":0,\"right\":1},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_src_del_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3975,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[cndtn]\"},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"Y\",\"dataType\":\"string\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[cndtn_key]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3964,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[cndtn_nm]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3965,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[cndtn_cd]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_cd\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4010,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[chrnc_cndtn_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"chrnc_cndtn_flg\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3967,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[risk_calc_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"risk_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4012,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[gap_calc_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"gap_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4013,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[cndtn_mgmt_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_mgmt_flg\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3970,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[tgt_cndtn_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"tgt_cndtn_flg\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3971,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[ref_prd_yr]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4016,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[meddra_cd]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"meddra_cd\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3973,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_meta_obj_key]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_meta_obj_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3974,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_src_del_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"N\",\"dataType\":\"string\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_created_dt]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_created_dt\",\"dataType\":\"timestamp\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3976,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_created_by]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_created_by\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3977,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_updated_dt]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.Literal\",\"num-children\":0,\"value\":\"2023-12-05 18:06:46.142\",\"dataType\":\"timestamp\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_updated_by]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_updated_by\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4023,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_row_hash]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_row_hash\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4024,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_src_meta_obj_key]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_src_meta_obj_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":3981,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":[]}]],\"notMatchedClauses\":[[{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeIntoNotMatchedInsertClause\",\"num-children\":18,\"actions\":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[cndtn_key]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4008,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[cndtn_nm]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_nm\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4009,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[cndtn_cd]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_cd\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4010,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[chrnc_cndtn_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"chrnc_cndtn_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4011,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[risk_calc_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"risk_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4012,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[gap_calc_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"gap_calc_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4013,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[cndtn_mgmt_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"cndtn_mgmt_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4014,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[tgt_cndtn_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"tgt_cndtn_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4015,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[ref_prd_yr]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"ref_prd_yr\",\"dataType\":\"integer\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4016,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[meddra_cd]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"meddra_cd\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4017,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_meta_obj_key]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_meta_obj_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4018,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_src_del_flg]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_src_del_flg\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4019,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_created_dt]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_created_dt\",\"dataType\":\"timestamp\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4020,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_created_by]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_created_by\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4021,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_updated_dt]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_updated_dt\",\"dataType\":\"timestamp\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4022,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_updated_by]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_updated_by\",\"dataType\":\"string\",\"nullable\":false,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4023,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_row_hash]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_row_hash\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4024,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"},{\"class\":\"org.apache.spark.sql.catalyst.plans.logical.DeltaMergeAction\",\"num-children\":1,\"targetColNameParts\":\"[udf_src_meta_obj_key]\",\"expr\":0,\"targetColNameResolved\":true},{\"class\":\"org.apache.spark.sql.catalyst.expressions.AttributeReference\",\"num-children\":0,\"name\":\"udf_src_meta_obj_key\",\"dataType\":\"string\",\"nullable\":true,\"metadata\":{},\"exprId\":{\"product-class\":\"org.apache.spark.sql.catalyst.expressions.ExprId\",\"id\":4025,\"jvmId\":\"5be17234-084b-4cfc-bcfe-aa31dcb0f2d8\"},\"qualifier\":\"[src]\"}]],\"migratedSchema\":{\"type\":\"struct\",\"fields\":[{\"name\":\"cndtn_key\",\"type\":\"string\",\"nullable\":false,\"metadata\":{\"comment\":\"md5 hash of (cndtn_nm)\"}},{\"name\":\"cndtn_nm\",\"type\":\"string\",\"nullable\":false,\"metadata\":{\"comment\":\"Condition Name\"}},{\"name\":\"cndtn_cd\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"Condition Code if any.\"}},{\"name\":\"chrnc_cndtn_flg\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"Indicator to identify the condition is chronic or not\",\"__CHAR_VARCHAR_TYPE_STRING\":\"char(1)\"}},{\"name\":\"risk_calc_flg\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"Indicator to identify the condition for risk calculation\",\"__CHAR_VARCHAR_TYPE_STRING\":\"char(1)\"}},{\"name\":\"gap_calc_flg\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"Indicator to identify the condition for gap calculation\",\"__CHAR_VARCHAR_TYPE_STRING\":\"char(1)\"}},{\"name\":\"cndtn_mgmt_flg\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"Condition Management Flag\",\"__CHAR_VARCHAR_TYPE_STRING\":\"char(1)\"}},{\"name\":\"tgt_cndtn_flg\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"Indicator to identify the condition for targeted campaign\",\"__CHAR_VARCHAR_TYPE_STRING\":\"char(1)\"}},{\"name\":\"ref_prd_yr\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{\"comment\":\"Reference Period (in Years)\"}},{\"name\":\"meddra_cd\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"Medical Dictionary for Regulatory Activities Code (If Applicable)\"}},{\"name\":\"udf_meta_obj_key\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"Captures the meta object key of the table to track the data lineage\"}},{\"name\":\"udf_src_del_flg\",\"type\":\"string\",\"nullable\":false,\"metadata\":{\"comment\":\"Indicator to show that the source record no longer exists\",\"__CHAR_VARCHAR_TYPE_STRING\":\"char(1)\"}},{\"name\":\"udf_created_dt\",\"type\":\"timestamp\",\"nullable\":false,\"metadata\":{\"comment\":\"Captures the timestamp when the record is created\"}},{\"name\":\"udf_created_by\",\"type\":\"string\",\"nullable\":false,\"metadata\":{\"comment\":\"Captures Pipeline Name, Pipeline Run Id with Tilde (~) as separator when the record is created\"}},{\"name\":\"udf_updated_dt\",\"type\":\"timestamp\",\"nullable\":false,\"metadata\":{\"comment\":\"Captures the timestamp when the record is recently updated\"}},{\"name\":\"udf_updated_by\",\"type\":\"string\",\"nullable\":false,\"metadata\":{\"comment\":\"Captures Pipeline Name, Pipeline Run Id with Tilde (~) as separator when the record is updated\"}},{\"name\":\"udf_row_hash\",\"type\":\"string\",\"nullable\":false,\"metadata\":{\"comment\":\"md5 hash of columns except natural key columns and audit columns (udf_ *)\"}},{\"name\":\"udf_src_meta_obj_key\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"Captures the meta object key of the data source\"}}]}}]},\"spark_version\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/2-0-2/OpenLineage.json#/$defs/RunFacet\",\"spark-version\":\"3.3.1.5.2-108696741\",\"openlineage-spark-version\":\"1.4.1\"},\"processing_engine\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-1-0/ProcessingEngineRunFacet.json#/$defs/ProcessingEngineRunFacet\",\"version\":\"3.3.1.5.2-108696741\",\"name\":\"spark\",\"openlineageAdapterVersion\":\"1.4.1\"},\"environment-properties\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/2-0-2/OpenLineage.json#/$defs/RunFacet\",\"environment-properties\":{}}}},\"job\":{\"namespace\":\"synw-udf-dlz-dv-eu2-01,azuresynapsespark\",\"name\":\"n_b_ccw_ref_condition_raw_to_conformed_lratest_1701799232.execute_merge_into_command.reference_ref_cndtn\",\"facets\":{}},\"inputs\":[],\"outputs\":[{\"namespace\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"name\":\"/reference/ref_cndtn\",\"facets\":{\"dataSource\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/DatasourceDatasetFacet.json#/$defs/DatasourceDatasetFacet\",\"name\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"uri\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\"},\"version\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/DatasetVersionDatasetFacet.json#/$defs/DatasetVersionDatasetFacet\",\"datasetVersion\":\"121\"},\"schema\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/SchemaDatasetFacet.json#/$defs/SchemaDatasetFacet\",\"fields\":[{\"name\":\"cndtn_key\",\"type\":\"string\"},{\"name\":\"cndtn_nm\",\"type\":\"string\"},{\"name\":\"cndtn_cd\",\"type\":\"string\"},{\"name\":\"chrnc_cndtn_flg\",\"type\":\"string\"},{\"name\":\"risk_calc_flg\",\"type\":\"string\"},{\"name\":\"gap_calc_flg\",\"type\":\"string\"},{\"name\":\"cndtn_mgmt_flg\",\"type\":\"string\"},{\"name\":\"tgt_cndtn_flg\",\"type\":\"string\"},{\"name\":\"ref_prd_yr\",\"type\":\"integer\"},{\"name\":\"meddra_cd\",\"type\":\"string\"},{\"name\":\"udf_meta_obj_key\",\"type\":\"string\"},{\"name\":\"udf_src_del_flg\",\"type\":\"string\"},{\"name\":\"udf_created_dt\",\"type\":\"timestamp\"},{\"name\":\"udf_created_by\",\"type\":\"string\"},{\"name\":\"udf_updated_dt\",\"type\":\"timestamp\"},{\"name\":\"udf_updated_by\",\"type\":\"string\"},{\"name\":\"udf_row_hash\",\"type\":\"string\"},{\"name\":\"udf_src_meta_obj_key\",\"type\":\"string\"}]},\"columnLineage\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-1/ColumnLineageDatasetFacet.json#/$defs/ColumnLineageDatasetFacet\",\"fields\":{\"cndtn_key\":{\"inputFields\":[{\"namespace\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"name\":\"/reference/ref_cndtn\",\"field\":\"cndtn_key\"}]},\"cndtn_nm\":{\"inputFields\":[{\"namespace\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"name\":\"/reference/ref_cndtn\",\"field\":\"cndtn_nm\"}]},\"cndtn_cd\":{\"inputFields\":[{\"namespace\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"name\":\"/reference/ref_cndtn\",\"field\":\"cndtn_cd\"}]},\"chrnc_cndtn_flg\":{\"inputFields\":[{\"namespace\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"name\":\"/reference/ref_cndtn\",\"field\":\"chrnc_cndtn_flg\"}]},\"risk_calc_flg\":{\"inputFields\":[{\"namespace\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"name\":\"/reference/ref_cndtn\",\"field\":\"risk_calc_flg\"}]},\"gap_calc_flg\":{\"inputFields\":[{\"namespace\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"name\":\"/reference/ref_cndtn\",\"field\":\"gap_calc_flg\"}]},\"cndtn_mgmt_flg\":{\"inputFields\":[{\"namespace\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"name\":\"/reference/ref_cndtn\",\"field\":\"cndtn_mgmt_flg\"}]},\"tgt_cndtn_flg\":{\"inputFields\":[{\"namespace\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"name\":\"/reference/ref_cndtn\",\"field\":\"tgt_cndtn_flg\"}]},\"meddra_cd\":{\"inputFields\":[{\"namespace\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"name\":\"/reference/ref_cndtn\",\"field\":\"meddra_cd\"}]},\"udf_meta_obj_key\":{\"inputFields\":[{\"namespace\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"name\":\"/reference/ref_cndtn\",\"field\":\"udf_meta_obj_key\"}]},\"udf_created_dt\":{\"inputFields\":[{\"namespace\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"name\":\"/reference/ref_cndtn\",\"field\":\"udf_created_dt\"}]},\"udf_created_by\":{\"inputFields\":[{\"namespace\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"name\":\"/reference/ref_cndtn\",\"field\":\"udf_created_by\"}]},\"udf_src_meta_obj_key\":{\"inputFields\":[{\"namespace\":\"abfss://conformednpii@studfmodelnpiidveu204.dfs.core.windows.net\",\"name\":\"/reference/ref_cndtn\",\"field\":\"udf_src_meta_obj_key\"}]}}},\"symlinks\":{\"_producer\":\"https://github.com/OpenLineage/OpenLineage/tree/1.4.1/integration/spark\",\"_schemaURL\":\"https://openlineage.io/spec/facets/1-0-0/SymlinksDatasetFacet.json#/$defs/SymlinksDatasetFacet\",\"identifiers\":[{\"namespace\":\"/reference\",\"name\":\"reference.ref_cndtn\",\"type\":\"TABLE\"}]}},\"outputFacets\":{}}]}";
            var olEvent = JsonConvert.DeserializeObject<Event>(olPayload);

            // Act
            Xunit.Assert.NotNull(olEvent);
            var actual = _validator.Validate(olEvent);

            // Chnage the validation logi

            // Assert
            Xunit.Assert.True(actual);
        }
    }
}